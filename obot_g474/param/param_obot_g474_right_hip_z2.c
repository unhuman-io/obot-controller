#include "param_obot_g474_aksim.h"
#include "math.h"
const volatile Param __attribute__ ((section ("flash_param"))) param_store = {
.fast_loop_param.foc_param.pi_d.kp = .8,
.fast_loop_param.foc_param.pi_d.ki = .08,
.fast_loop_param.foc_param.pi_d.kp2 = .25,
.fast_loop_param.foc_param.pi_d.ki2 = .03,
.fast_loop_param.foc_param.pi_d.value2 = 100,
.fast_loop_param.foc_param.pi_d.ki_limit = 35,
.fast_loop_param.foc_param.pi_d.command_max = 3,
.fast_loop_param.foc_param.pi_q.kp = .8,
.fast_loop_param.foc_param.pi_q.ki = .08,
.fast_loop_param.foc_param.pi_q.kp2 = .25,
.fast_loop_param.foc_param.pi_q.ki2 = .03,
.fast_loop_param.foc_param.pi_q.value2 = 100,
.fast_loop_param.foc_param.pi_q.ki_limit = 35,
.fast_loop_param.foc_param.pi_q.command_max = 3,
.fast_loop_param.foc_param.current_filter_frequency_hz = 20000,
.fast_loop_param.foc_param.num_poles = 10,
.fast_loop_param.adc1_gain = -3.3/4096/(.001*10)*1.000,
.fast_loop_param.adc2_gain = -3.3/4096/(.001*10)*1.004,
.fast_loop_param.adc3_gain = -3.3/4096/(.001*10)*1.011,
.fast_loop_param.vbus_gain = 1.0/4096*(215+13.7)/13.7,
.fast_loop_param.cogging.gain = 0,
.fast_loop_param.motor_encoder.dir = -1.0,
.fast_loop_param.motor_encoder.use_index_electrical_offset_pos = 1,
.fast_loop_param.motor_encoder.cpr = pow(2,19),
.fast_loop_param.motor_encoder.rollover = pow(2,25),
.fast_loop_param.motor_encoder.index_electrical_offset_pos = 37382,
.fast_loop_param.phase_mode = 1,
.fast_loop_param.beep_amplitude = 1,
.fast_loop_param.beep_frequency = 300,
.fast_loop_param.ia_bias = 2.871,
.fast_loop_param.ib_bias = 2.163,
.fast_loop_param.ic_bias = 3.248,
.fast_loop_param.current_direction = 1,
.main_loop_param.motor_temperature_model.resistance = 0.067,
.main_loop_param.motor_temperature_model.Cp = 40,
.main_loop_param.motor_temperature_model.Rth = 0.5,
.main_loop_param.torque_sensor.gain = 127,
.main_loop_param.torque_sensor.bias = 0,
.main_loop_param.state_controller_param.command_max = 10,
.main_loop_param.state_controller_param.output_filter_frequency_hz = 1000,
.main_loop_param.state_controller_param.velocity_filter_frequency_hz = 1000,
.main_loop_param.state_controller_param.torque_filter_frequency_hz = 1000,
.main_loop_param.state_controller_param.torque_dot_filter_frequency_hz = 1000,
.main_loop_param.position_controller_param.position.kp = 300,
.main_loop_param.position_controller_param.position.kd = 3,
.main_loop_param.position_controller_param.position.velocity_filter_frequency_hz = 1000,
.main_loop_param.position_controller_param.position.output_filter_frequency_hz = 1000,
.main_loop_param.position_controller_param.position.command_max = 10,
.main_loop_param.velocity_controller_param.velocity.ki = 300,
.main_loop_param.velocity_controller_param.velocity.kp = 3,
.main_loop_param.velocity_controller_param.velocity.ki_limit = 8,
.main_loop_param.velocity_controller_param.velocity.output_filter_frequency_hz = 1000,
.main_loop_param.velocity_controller_param.velocity.command_max = 10,
.main_loop_param.velocity_controller_param.acceleration_limit = 1000,
.main_loop_param.output_encoder.cpr = -pow(2,20),
.main_loop_param.output_encoder.bias = 4.2634,
.main_loop_param.host_timeout = 1000,    // control loop cycles at 10 kHz. For example 100 would set a 10 ms timeout,
.main_loop_param.safe_mode = CURRENT,
.main_loop_param.encoder_limits.output_hard_max = 0.765,
.main_loop_param.encoder_limits.output_hard_min = -0.765,
.main_loop_param.encoder_limits.motor_controlled_max = 51*.75,
.main_loop_param.encoder_limits.motor_controlled_min = -51*.75,
.main_loop_param.encoder_limits.motor_hard_max = 51*.765,
.main_loop_param.encoder_limits.motor_hard_min = -51*.765,
.main_loop_param.error_mask.all = ERROR_MASK_ALL,
.main_loop_param.safe_mode_driver_disable = 0,
.main_loop_param.no_latch_driver_fault = 1,
.main_loop_param.joint_position_controller_param.velocity.velocity.kp = 1,
.main_loop_param.joint_position_controller_param.velocity.velocity.ki = 100,
.main_loop_param.joint_position_controller_param.velocity.velocity.ki_limit = 2.5,
.main_loop_param.joint_position_controller_param.velocity.velocity.command_max = 3,
.main_loop_param.joint_position_controller_param.kpj = 1000,
.drv_regs = {(2<<11) | 0x00, 
 (3<<11) | 0x3FF,
 (4<<11) | 0x37F,
 (5<<11) | 0x004,
 (6<<11) | 0x240},
.startup_param.startup_mode = OPEN,
.startup_param.do_phase_lock = 0,
.startup_param.phase_lock_current = 15,
.startup_param.phase_lock_duration = 2,
.startup_param.gear_ratio = 51,
.startup_param.no_driver_enable = 1,
.startup_param.no_zero_current_sensors = 1,
.startup_param.motor_encoder_startup = ENCODER_BIAS_FROM_OUTPUT_WITH_MOTOR_CORRECTION,
.startup_param.motor_encoder_bias = 15.1537,
.startup_param.output_encoder_rollover = M_PI,
.name = "right_hip_z",
};